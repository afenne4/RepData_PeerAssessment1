---
title: "Reproducible Research Course Project 1"
author: "Alex Fennell"
date: "1/7/2022"
output: html_document
---

```{r libraries, message=FALSE}
    library(dplyr)
    library(ggplot2)
```

## Loading and preprocessing the data

```{r download data}
fileurl<-"https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
if (!file.exists("CP1data.zip")){
    download.file(fileurl,"CP1data.zip",method="curl")
    unzip("CP1data.zip")
}
act<-read.csv("activity.csv")
act$date<-as.Date(act$date, format="%Y-%m-%d")
str(act)

```
With the data in the desired format now, it is necessary to get a quick idea of
the data using summary
```{r}
summary(act)
```
This shows a good amount of missing data ~13% so to calculate the mean it is 
necessary to remove the NA values

## What is mean total number of steps taken per day?
```{r histogram of step, message=FALSE}
totalsteps<-act %>%
    group_by(date) %>%
    na.omit(steps) %>%
    summarise(totsteps=sum(steps))
    qplot(totalsteps$totsteps,
          main="Total Steps Taken Each Day",
          xlab="Total Steps")+
    theme(plot.title=element_text(hjust=.5))
```

```{r mean steps}
    totalsteps%>%
    summarise(mean(totsteps),median(totsteps))
```


## What is the average daily activity pattern?
```{r time series plot}
avgsteps <- act%>%
            group_by(interval)%>%
            summarise(mnstp=mean(steps,na.rm=TRUE))
ts1<-ggplot(avgsteps,aes(interval,mnstp))
ts1+geom_line()+
    labs(title="Average Number of Steps Across Days",
         y="Average Number of Steps",
         x="5-minute time interval")+
        theme(plot.title=element_text(hjust=.5))

```

This means that the time interval that contains the maximum average steps is
```{r max steps time interval}
avgsteps[which(max(avgsteps$mnstp)==avgsteps$mnstp),1]
```
## Imputing missing values

### Number of missing values
```{r}
sum(is.na(act))
```
To fill in the missing values I am going to use the mean steps across all days
for the corresponding 5 minute interval

```{r impute data}
actimpute<-act%>%
    group_by(interval)%>%
    mutate(steps=ifelse(is.na(steps),mean(steps,na.rm=TRUE),steps))

```

### Histogram of imputed data set
```{r}
imputetotalsteps<-actimpute %>%
    group_by(date) %>%
    summarise(tsteps=sum(steps))
    qplot(imputetotalsteps$tsteps,
          main="Total Steps Taken Each Day",
          xlab="Total Steps")+
    theme(plot.title=element_text(hjust=.5))
```

### Mean and Median of steps each day with imputed data set
```{r mean and median of imputed data}
imputetotalsteps%>%
    summarise(mean(tsteps),median(tsteps))

```

The mean value for the imputed data set has not changed, however the median 
did change to the same value as the median. 

## Are there differences in activity patterns between weekdays and weekends?
